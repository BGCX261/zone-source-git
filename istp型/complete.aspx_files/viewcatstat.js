var _hash=new Object();var chartObject=new Object();var reportData=new Object();var dataToSave=new Array();var tableData=new Object();var tableNotSave=new Array();var matrixToSave=new Array();var matrixArray=new Object();var isDownloading=false;function ReportItem(){this.catid=0;this.type=1;this.data="";this.width=400;this.height=350;this.matrix=false;}var chartHeader="<chart caption='' palette='2' showToolTip='1' showFCMenuItem='0' imageSave='1' imageSaveURL='/wjx/ActivityStat/FusionChartSave.aspx' animation='1' baseFontSize ='12' bgColor='eeeeee,FFFFFF' borderColor='1D8BD1' borderThickness='1' borderAlpha='50' bgAlpha='30' showBorder='1' subCaption=''  showValues='1' formatNumberScale='0' showPercentValues='1'  pieYScale='48'  showYAxisValues='0' radarFillColor='ffffff'>";var chartTrailer="<styles><definition><style type='font' name='CaptionFont' color='666666' size='15' /><style type='font' name='SubCaptionFont' bold='0' /></definition><application><apply toObject='caption' styles='CaptionFont' /><apply toObject='SubCaption' styles='SubCaptionFont' /></application></styles></chart>";var chartRaderHeader="<chart caption=''  showValues='1' bgColor='FFFFFF' radarFillColor='FFFFFF' plotFillAlpha='5' numDivLines='0'  showFCMenuItem='0' exportEnabled='1'  exportAtClient='0' exportAction='download'  exportHandler='/wjx/ActivityStat/FusionChartsSave.aspx' plotBorderThickness='2' anchorAlpha='100' borderColor='1D8BD1' borderThickness='1' borderAlpha='50' bgAlpha='30' showBorder='0' >";function GetChartData(g,e){var l="";var k=0;var a="";var b=false;if(chartObject[g]&&chartObject[g].removeEmpty){b=true;}if(matrixData[g]){var c=Number(g.substring(7));var m=matrixData[g];var f="chartId"+(c+1);a+=" <categories>";for(k=0;k<chartData[f].length;k++){a+="<category label='"+chartData[f][k][0]+"' />";}a+=" </categories>";var h=1;for(k=0;k<m.length;k++){f="chartId"+(c+h);if(!chartData[f]){h++;f="chartId"+(c+h);}a+="<dataset seriesName='"+m[k]+"'>";for(j=0;j<chartData[f].length;j++){a+="<set value='"+chartData[f][j][1]+"'";if(chartData[f][j].length>2){a+=" toolText='"+chartData[f][j][2]+"'";}a+=" />";}a+="</dataset>";h++;}}else{for(k=0;k<chartData[g].length;k++){if(chartData[g][k][1]<1&&b){continue;}a+="<set label='"+chartData[g][k][0]+"' value='"+chartData[g][k][1]+"'";if(chartData[g][k].length>2){a+=" toolText='"+chartData[g][k][2]+"'";}a+=" />";}}l=l+a;l=l+chartTrailer;if(e){return a;}else{return l;}}var downloadWindow=null;function openwindow(b,a,c,g){var e=window.screen.availHeight-1;var d=window.screen.availWidth-1;var f="height="+g+",innerHeight="+g+",width="+c+",innerWidth="+c+",top="+e+",left="+d+",border=no,toolbar=no,menubar=no,scrollbars=yes,resizable=yes,location=no,status=no";downloadWindow=window.open(b,a,f);downloadWindow.blur();}function GenerateReport(){dataToSave=new Array();var a=0;for(var b in reportData){dataToSave[a]=reportData[b];dataToSave[a].data=GetChartData(b.substring(0,b.length-1),true);a++;}a=0;dataToSave.sort(function(d,c){return d.catid-c.catid;});tableNotSave=new Array();for(var b in tableData){tableNotSave[a]=b;a++;}a=0;matrixToSave=new Array();for(var b in matrixArray){matrixToSave[a]=b;a++;}isDownloading=true;window.parent.startDownloading=true;openwindow("/wjx/activitystat/SaveCatChart.aspx?activity="+activityId+"&joinid="+joinId,"生成报告",1000,800);}function finishDownloading(){if(window.parent.NextClick){window.parent.NextClick();}}function hideZero(a,c,k,h,f){if(!chartObject[k]){chartObject[k]=new Object();}chartObject[k].removeEmpty=chartObject[k].removeEmpty?false:true;f.innerHTML=chartObject[k].removeEmpty?"显示零数据":"隐藏零数据";var g=f.parentNode.parentNode.parentNode.parentNode;var b=g.getElementsByTagName("table")[0].tBodies[0];var l=b.rows;for(i=0;i<l.length;i++){var e=l[i].cells[1].innerHTML;if(e=="0"){l[i].style.display=chartObject[k].removeEmpty?"none":"";}}}var prevChart=new Object();function showChart(d,b,k,e,f){var a=document.getElementById(d);var h;if(f==1){h=document.getElementById("displayBin");}if(f==2){h=document.getElementById("displayBar");}if(f==3){h=document.getElementById("displayZhe");}if(f==4){h=document.getElementById("displayTiao");}if(e==1){a.style.display=a.style.display==""?"none":"";if(a.style.display==""&&prevChart[k]&&prevChart[k]!=a){prevChart[k].style.display="none";}prevChart[k]=a;}else{a.style.display=h.checked?"":"none";}var g=a.parentNode.offsetWidth?a.parentNode.offsetWidth*9/10:400;if(!generateReport){displayChart(k,b,f,g,350,false,a.style.display=="");}else{displayChart(k,b,f,560,300,false,a.style.display=="");}if(window.parent){if(window.parent.SetCwinHeight){setTimeout(function(){window.parent.SetCwinHeight();},200);}if(window.parent.startDownloading){GenerateReport();}}}function setReportData(h,f,e,a,g){var c=h+f;var d=false;if(matrixData[h]){d=true;}if(!g){delete reportData[c];}else{var b=reportData[c];if(b){b.width=e;b.height=a;}else{b=new ReportItem();b.catid=parseInt(Number(h.substring(7))/10000);b.type=f;b.data="";b.width=e;b.height=a;b.matrix=d;reportData[c]=b;}}}function displayChart(m,b,d,a,l,f,g){var c;var k=m+d;var h=false;if(matrixData[m]){h=true;}setReportData(m,d,a,l,g);if(!_hash[k]){_hash[k]=k;}else{if(!f&&!chartObject[b]){return;}}if(!h){if(d==1){c=new FusionCharts("/Images/wjx/viewstat/Radar.swf",k,a,l,"0","1");}else{if(d==2){c=new FusionCharts("/Images/wjx/viewstat/Column3D.swf",k,a,l,"0","1");}else{if(d==3){c=new FusionCharts("/Images/wjx/viewstat/line.swf",k,a,l,"0","1");}else{if(d==4){c=new FusionCharts("/Images/wjx/viewstat/bar2d.swf",k,a,l,"0","1");}}}}}else{if(d==1){c=new FusionCharts("/Images/wjx/viewstat/Radar.swf",k,a,l,"0","1");}else{if(d==2){c=new FusionCharts("/Images/wjx/viewstat/MSColumn3D.swf",k,a,l,"0","1");}else{if(d==3){c=new FusionCharts("/Images/wjx/viewstat/Msline.swf",k,a,l,"0","1");}else{if(d==4){c=new FusionCharts("/Images/wjx/viewstat/Msbar3d.swf",k,a,l,"0","1");}}}}}var e=GetChartData(m,false);if(d==1){e=chartRaderHeader+e;}else{e=chartHeader+e;}c.setDataXML(e);c.render(b);}function showTable(b,a,d){var f=document.getElementById(a);var e=document.getElementById("displayTable");if(d==1){f.style.display=f.style.display==""?"none":"";}else{f.style.display=e.checked?"":"none";}if(tableData[b]){delete tableData[b];}else{tableData[b]=b;}}var arrayData=new Array();function enlargeChart(c,g,f,e){var d=400;var a=350;var b=g+f;if(arrayData[b]){d=arrayData[b][0];a=arrayData[b][1];}else{arrayData[b]=new Array();}if(e){d=d*5/4;a=a*5/4;}else{d=d*4/5;a=a*4/5;}arrayData[b][0]=d;arrayData[b][1]=a;displayChart(g,c,f,d,a,true,true);}function saveChart(c,e,d){var b=e+d;var a=getChartFromId(b);a.saveAsImage();}function printChart(c,e,d){var b=e+d;var a=getChartFromId(b);a.print();}function Display(f){if(f.name=="displayBin"){processDiv(1,f);}else{if(f.name=="displayBar"){processDiv(2,f);}else{if(f.name=="displayZhe"){processDiv(3,f);}else{if(f.name=="displayTiao"){processDiv(4,f);}else{if(f.name=="displayTable"){var h=document.getElementById("ulList").getElementsByTagName("table");for(var e=0;e<h.length;e++){if(h[e].id.indexOf("tbItemCounter")>-1){var l=h[e];var b=h[e].id.substring(0,h[e].id.length-13)+"chartDivData";showTable(document.getElementById(b).innerHTML,h[e].id,0);}}}else{if(f.name=="displayValue"){var a=document.getElementById("ulList").getElementsByTagName("span");for(var c=0;c<a.length;c++){if(a[c].id.indexOf("lblValue")>-1){var g=document.getElementById(a[c].id);g.style.display=g.style.display==""?"none":"";}}var d=document.getElementById("lblValueTotal");if(d==null){return;}d.style.display=d.style.display==""?"none":"";}}}}}}}function processDiv(l,k){var h=document.getElementById("ulList").getElementsByTagName("div");var f=1;for(var g=0;g<h.length;g++){if(h[g].id.indexOf("chartDiv"+l)>-1&&h[g].id.indexOf("chartDiv"+l+"Con")==-1){var b=h[g].id;var e=h[g].id+"Con";var d=h[g].id.substring(0,h[g].id.length-1)+"Data";document.getElementById(e).style.display="";var m="chartId"+document.getElementById(d).innerHTML;var a='showChart("'+e+'","'+b+'","'+m+'",0,'+l+")";setReportData(m,l,400,350,k.checked);if(!k.checked){document.getElementById(e).style.display="none";}else{setTimeout(a,1000*f);f+=1;}}}}function ShowMatrix(a,e,b,d){var c=document.getElementById(a);c.style.display=c.style.display=="none"?"":"none";d.innerHTML=c.style.display=="none"?"查看详细数据":"查看总体数据";var f=document.getElementById(b);f.style.display=f.style.display=="none"?"":"none";if(matrixArray[e]){delete matrixArray[e];}else{matrixArray[e]=a;}}window.onbeforeunload=function(){if(downloadWindow&&isDownloading){return("正在生成调查报告，关闭此窗口后，将不能正确生成，确定关闭吗？");}};if(window.ids&&!window.notShowChartWhenLoaded){var idArray=ids.split(",");for(var jj=0;jj<idArray.length;jj++){if(idArray[jj]!=""){var func=document.getElementById(idArray[jj]).href;setTimeout(func,200);}}}